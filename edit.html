<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dynamic Form Generator</title>
    <style>
      .form-group {
        margin-bottom: 15px;
      }
      .form-input,
      .form-select {
        width: 100%;
        padding: 8px;
        box-sizing: border-box;
      }
      .form-button {
        margin-top: 10px;
        padding: 10px 15px;
        background-color: #007bff;
        color: white;
        border: none;
        cursor: pointer;
      }
      .form-button:hover {
        background-color: #0056b3;
      }
    </style>
  </head>
  <body>
    <a href="./index.html"><button class="form-button">Home</button></a>
    <h1>Enter JSON Data</h1>
    <textarea
      id="json-input"
      placeholder="Enter JSON data here"
      rows="10"
      style="width: 100%"
    ></textarea>
    <button id="generate-form" class="form-button">Generate Form</button>

    <form id="dynamicForm" style="margin-top: 20px">
      <h1>Generated Form</h1>
      <!-- Dynamically generated form fields will appear here -->
    </form>

    <script>
      document
        .getElementById("generate-form")
        .addEventListener("click", function () {
          const jsonInput = document.getElementById("json-input").value;
          const formContainer = document.getElementById("dynamicForm");
          formContainer.innerHTML = "<h1>Generated Form</h1>"; // Reset form contents

          try {
            const jsonData = JSON.parse(jsonInput);

            // Iterate through the keys in the JSON object (strategy names)
            for (let strategyName in jsonData) {
              if (jsonData.hasOwnProperty(strategyName)) {
                const strategy = jsonData[strategyName];

                // Create a section for each strategy
                const strategySection = document.createElement("div");
                strategySection.innerHTML = `<h2>${
                  strategyName.charAt(0).toUpperCase() + strategyName.slice(1)
                }</h2>`;
                formContainer.appendChild(strategySection);

                // Create input for 'class' if it exists
                if (strategy.class !== undefined) {
                  const inputGroup = document.createElement("div");
                  inputGroup.classList.add("form-group");
                  inputGroup.innerHTML = `
                <label for="${strategyName}_class">Class:</label>
                <input type="text" id="${strategyName}_class" name="${strategyName}_class" class="form-input" value="${
                    strategy.class || ""
                  }">
            `;
                  formContainer.appendChild(inputGroup);
                }

                // Create input for 'universe'
                if (strategy.universe !== undefined) {
                  const inputGroup = document.createElement("div");
                  inputGroup.classList.add("form-group");
                  inputGroup.innerHTML = `
                <label for="${strategyName}_universe">Universe:</label>
                <input type="text" id="${strategyName}_universe" name="${strategyName}_universe" class="form-input" value="${strategy.universe}">
            `;
                  formContainer.appendChild(inputGroup);
                }

                // Handle filters if they exist
                if (strategy.filters && Array.isArray(strategy.filters)) {
                  strategy.filters.forEach((filter, index) => {
                    const filterGroup = document.createElement("div");
                    filterGroup.classList.add("form-group");

                    let filterHtml = `
                  <label for="${strategyName}_filter_${index}">Filter ${
                      index + 1
                    } (${filter.filter}):</label>
                  `;

                    // Loop through the options of the filter
                    for (let optionKey in filter.options) {
                      filterHtml += `
                    <label for="${strategyName}_filter_${index}_${optionKey}">${optionKey}:</label>
                    <input type="text" id="${strategyName}_filter_${index}_${optionKey}" name="${strategyName}_filter_${index}_${optionKey}" class="form-input" value="${filter.options[optionKey]}">
                `;
                    }

                    filterGroup.innerHTML = filterHtml;
                    formContainer.appendChild(filterGroup);
                  });
                }
              }
            }

            // Append submit button at the end
            const submitButton = document.createElement("button");
            submitButton.type = "submit";
            submitButton.classList.add("form-button");
            submitButton.textContent = "Submit";
            formContainer.appendChild(submitButton);
          } catch (error) {
            alert("Invalid JSON data");
          }
        });
    </script>
  </body>
</html>
